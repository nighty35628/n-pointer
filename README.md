博文地址: https://blog.nightytech.com/n-pointer/

# N-Pointer (All-in-One 手势鼠标)

这是一个基于 MediaPipe 和 PyQt6 开发的单手全能手势识别鼠标控制系统。

## 核心特性

- **单手操作**：通过一只手即可完美控制移动、点击、滚动、复位及系统指令。
- **集成 GUI (PyQt6)**：内置 400x300 实时监控窗口，支持左右手一键切换。
- **类鼠标体验**：配置了 1.8x 高灵敏度映射及 3.0 平滑过滤，操作丝滑。
- **智能过滤**：移动手势优先机制，防止移动时光标误点击。

## 手势定义

| 动作 | 手势描述 | 说明 |
| :--- | :--- | :--- |
| **鼠标移动** | **剑指 (食指 + 中指并拢)** | 精度映射至全屏，支持边缘锁定 |
| **左键按下/抬起** | **食指 + 大拇指捏合** | 模拟鼠标左键长按与松开 |
| **右键点击** | **中指 + 大拇指捏合** | 触发一次鼠标右键点击 |
| **滚轮滚动** | **无名指 + 大拇指捏合** | 捏合后**上下移动**手部进行滚动 |
| **光标复位** | **五指张开 (且手背面向摄像头)** | 保持 1 秒，光标将重置到屏幕中心 |
| **显示桌面** | **复位成功瞬间握拳** | 复位计时结束后的 1.2s 内捏拳，触发 Win+D |

## 运行环境

- Python 3.9+ (推荐 3.14 以兼容最新特性)
- 依赖库安装：
  ```bash
  pip install opencv-python mediapipe pyautogui numpy PyQt6
  ```

## 快速开始

运行主程序：
```bash
python hand_controller.py
```

## 配置说明 (代码内部已预设)

程序默认采用了以下优化参数（UI 中已隐藏滑块）：
- **H/V Sens**: 1.8 (高灵敏度，小幅度移动覆盖全屏)
- **Smoothing**: 3.0 (平衡延迟与抖动)
- **Lock Range**: 0.002 (极致精准的静止锁定阈值)

## 注意事项

- **手背复位**：复位手势必须确保**手背**面向摄像头，以防在使用平铺手势时误触发。
- **安全退出**：直接关闭 GUI 窗口或在终端按 `Ctrl+C` 即可安全终止程序。
- **自动模型下载**：首次运行会在线下载 MediaPipe 模型文件 `hand_landmarker.task`。
- **Failsafe**：若鼠标失控，程序已关闭 PyAutoGUI 默认屏角退出，请直接关闭程序窗口。

---
*Created by Gemini 3 Flash (Preview) & GitHub Copilot*
